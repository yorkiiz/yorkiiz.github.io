
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>yorkiiz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="yorkiiz">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="yorkiiz">
<meta property="og:url" content="https://yorkiiz.github.io/index.html">
<meta property="og:site_name" content="yorkiiz">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="yorkiiz">
<meta name="twitter:card" content="summary">

    
    <link rel="alternative" href="/atom.xml" title="yorkiiz" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/%02.css">
<link rel="stylesheet" href="/.css">

<meta name="generator" content="Hexo 5.4.0"></head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="yorkiiz" title="yorkiiz"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="yorkiiz">yorkiiz</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:yorkiiz.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/27/第三次复习/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-27T14:38:24.608Z" itemprop="datePublished"> Published 2021-08-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="第三次复习"><a href="#第三次复习" class="headerlink" title="第三次复习"></a>第三次复习</h3><h3 id="spring"><a href="#spring" class="headerlink" title="spring"></a>spring</h3><p>管理bean</p>
<p>IOC：控制反正，交给spring去管理</p>
<p>aop：动态代理，默认，实现了接口的jdk，否则是cglib，也可以配置</p>
<h4 id="IOC过程"><a href="#IOC过程" class="headerlink" title="IOC过程"></a>IOC过程</h4><p>1.扫描</p>
<p>2.将扫描的结果封装为beandefenition，放到beandefinitionmap</p>
<p>3.实例化bean，调用getBean，封装成beanwrapper</p>
<p>4.applybeanpostprocessorbeforeinitialization</p>
<p>5.invokeinitmethods调用bean初始化方法</p>
<p>6.applybeanpostprocessor</p>
<p>7销毁</p>
<h3 id="springboot"><a href="#springboot" class="headerlink" title="springboot"></a>springboot</h3><h4 id="传播机制"><a href="#传播机制" class="headerlink" title="传播机制"></a>传播机制</h4><p>required：</p>
<p>required_new：</p>
<p>nested：</p>
<h4 id="失效的场景"><a href="#失效的场景" class="headerlink" title="失效的场景"></a>失效的场景</h4><p>1.不是public，final</p>
<p>2.数据库不支持</p>
<p>3.没有调用代理类的方法，调用自己的方法</p>
<p>4.可配的异常类型。默认runtime，可以配置其他的</p>
<h3 id="mybatis"><a href="#mybatis" class="headerlink" title="mybatis"></a>mybatis</h3>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/27/复习第二天/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-26T17:31:43.406Z" itemprop="datePublished"> Published 2021-08-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="复习第二天"><a href="#复习第二天" class="headerlink" title="复习第二天"></a>复习第二天</h3><p>1.mybatis的一二级缓存的区别</p>
<p>一级-sqlsession</p>
<p>二级-xml文件</p>
<h4 id="全链路压测，接口压测"><a href="#全链路压测，接口压测" class="headerlink" title="全链路压测，接口压测"></a>全链路压测，接口压测</h4><p>jmeter</p>
<h4 id="创建型"><a href="#创建型" class="headerlink" title="创建型"></a>创建型</h4><p>单例，工厂，建造者，原型</p>
<h4 id="结构型"><a href="#结构型" class="headerlink" title="结构型"></a>结构型</h4><p>装饰，桥接，代理，组合</p>
<h4 id="行为型"><a href="#行为型" class="headerlink" title="行为型"></a>行为型</h4><p>策略，委派，责任链</p>
<h4 id="饿汉"><a href="#饿汉" class="headerlink" title="饿汉"></a>饿汉</h4><p>类加载的时候初始化，创建对象安全，内存浪费</p>
<h4 id="饿汉式"><a href="#饿汉式" class="headerlink" title="饿汉式"></a>饿汉式</h4><p>不会浪费，怎么保证安全</p>
<p>双重检查锁：外面的性能，里面的安全 dcl</p>
<p>静态内部类：懒加载</p>
<h4 id="注册式"><a href="#注册式" class="headerlink" title="注册式"></a>注册式</h4><p>枚举：饿汉</p>
<p>容器式单例：</p>
<p>反射，序列化，clone</p>
<p>反射：重写私有构造方法</p>
<p>序列化：重写readResoleve，返回单例</p>
<h4 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h4><p>mybatis和aop</p>
<p>1.类加载器，接口，invokehandler</p>
<p>2.生产类通过反射并且需要实现被代理类的所有接口</p>
<p>cglib</p>
<p>生产多个fastclass，</p>
<p>asm框架，fastclass机制调用</p>
<p>jdk要有接口，cglib不是接口继承父类</p>
<p>jdk更慢，cglib更快</p>
<p>jdk需要public方法</p>
<h4 id="高可用"><a href="#高可用" class="headerlink" title="高可用"></a>高可用</h4><p>1.集群</p>
<p>2.降级</p>
<p>3.拆分服务</p>
<p>4.动态扩容</p>
<p>5.限流</p>
<p>6.熔断</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/27/代理模式/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-26T17:31:40.862Z" itemprop="datePublished"> Published 2021-08-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><p>代理模式是对对象的功能增强。比如前置通知和后置通知。</p>
<p>代理模式分为两种，静态代理，动态代理；动态代理又分为jdk代理和cglib代理。</p>
<h4 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h4><p>通常被代理对象实现同一个接口，代理对象通过接口动态构造了被代理对象，并且把被代理对象的接口方法做逐一的增强。</p>
<p><img src="https://raw.githubusercontent.com/yorkiiz/picture/master/20210826205158.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface Car &#123;</span><br><span class="line"></span><br><span class="line">    void drive();</span><br><span class="line"></span><br><span class="line">    void stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Benz implements Car &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void drive() &#123;</span><br><span class="line">        System.out.println(&quot;Benz car drive&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void stop() &#123;</span><br><span class="line">        System.out.println(&quot;Benz car stop&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Baoma implements Car &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void drive() &#123;</span><br><span class="line">        System.out.println(&quot;Baoma Car drive&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void stop() &#123;</span><br><span class="line">        System.out.println(&quot;Baoma car stop&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public class Driver &#123;</span><br><span class="line">    private Car car;</span><br><span class="line">    public Driver(Car car)&#123;</span><br><span class="line">        this.car = car;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void drive()&#123;</span><br><span class="line">        before();</span><br><span class="line">        car.drive();</span><br><span class="line">        after();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void stop()&#123;</span><br><span class="line">        before();</span><br><span class="line">        car.stop();</span><br><span class="line">        after();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void before()&#123;</span><br><span class="line">        System.out.println(&quot;**************&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void after()&#123;</span><br><span class="line">        System.out.println(&quot;--------------&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Driver driver = new Driver(new Baoma());</span><br><span class="line">        driver.drive();</span><br><span class="line">        driver.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h4><p>动态代理分两种，jdk和cglib</p>
<h4 id="jdk代理"><a href="#jdk代理" class="headerlink" title="jdk代理"></a>jdk代理</h4><p>jdk是jdk自带的代理，不需要任何依赖，对象需要实现同一个接口，代理对象需要实现InvocationHandler，依赖倒置原则，减少对代理类的依赖</p>
<p><img src="https://raw.githubusercontent.com/yorkiiz/picture/master/20210827000052.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class JdkDriver implements InvocationHandler &#123;</span><br><span class="line">    private Car car;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">        before();</span><br><span class="line">        Object result = method.invoke(this.car,args);</span><br><span class="line">        after();</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public  Car getInstance(Car car)&#123;</span><br><span class="line">        this.car = car;</span><br><span class="line">        Class&lt;?&gt; clazz = car.getClass();</span><br><span class="line">        return (Car)Proxy.newProxyInstance(clazz.getClassLoader(),clazz.getInterfaces(),this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void before()&#123;</span><br><span class="line">        System.out.println(&quot;****************&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void after()&#123;</span><br><span class="line">        System.out.println(&quot;-----------------&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        JdkDriver jdkDriver = new JdkDriver();</span><br><span class="line">        Car car = jdkDriver.getInstance(new Baoma());</span><br><span class="line">        car.drive();</span><br><span class="line">        car.speed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反射代理类，实现InvocationHandler，实现ivoke方法，对类方法进行修饰；提供get方法，return jdk的proxy类的代理生成对象，需要classloader，interfaces，this；</p>
<p>反射原理：动态生成源代码-&gt;输出到磁盘-&gt;编译成.class文件-&gt;加载到jvm中使用</p>
<h4 id="Cglib代理"><a href="#Cglib代理" class="headerlink" title="Cglib代理"></a>Cglib代理</h4><p>不需要实现特定的接口，cglib代理类实现MethodInterceptor，提供intercept和get方法</p>
<p><img src="https://raw.githubusercontent.com/yorkiiz/picture/master/20210827011445.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class Car &#123;</span><br><span class="line">    public void buy()&#123;</span><br><span class="line">        System.out.println(&quot;i want to buy a car&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public class Mycglibproxy implements MethodInterceptor &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Object intercept(Object o, Method method, Object[] objects, MethodProxy methodProxy) throws Throwable &#123;</span><br><span class="line">        before();</span><br><span class="line">        Object obj = methodProxy.invokeSuper(o,objects);</span><br><span class="line">        after();</span><br><span class="line">        return obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object getInstance(Class&lt;?&gt; clazz)&#123;</span><br><span class="line">        Enhancer enhancer = new Enhancer();</span><br><span class="line">        enhancer.setSuperclass(clazz);</span><br><span class="line">        enhancer.setCallback(this);</span><br><span class="line">        return enhancer.create();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void before()&#123;</span><br><span class="line">        System.out.println(&quot;****************&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void after()&#123;</span><br><span class="line">        System.out.println(&quot;-----------------&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Test &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Car car = (Car) new  Mycglibproxy().getInstance(Car.class);</span><br><span class="line">        car.buy();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><p>1.jdk代理基于反射，cglib使用的是asm框架，fastclass机制</p>
<p>2.jdk一定要有接口，cglib不能实现final类</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/24/redis list/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-23T18:12:53.512Z" itemprop="datePublished"> Published 2021-08-24</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="redis-list"><a href="#redis-list" class="headerlink" title="redis list"></a>redis list</h3><p>指令：</p>
<p>flushall 删库跑路</p>
<p>lpush queue c</p>
<p>lpush queue d e</p>
<p>rpush queue f g</p>
<p>lpop queue </p>
<p>rpop queue</p>
<p>lindex queue 0          单个索引获取数据</p>
<p>lrange queue 0 -1     获取所有数据</p>
<p><strong>特点：</strong></p>
<p>数据可以重复</p>
<p>简单的消息队列：</p>
<p>rpush lpop</p>
<p>blpop key1 timeput</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/24/redis hash/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-23T18:12:53.511Z" itemprop="datePublished"> Published 2021-08-24</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="redis-hash"><a href="#redis-hash" class="headerlink" title="redis hash"></a>redis hash</h3><h4 id="1-1string来存储多个键值对"><a href="#1-1string来存储多个键值对" class="headerlink" title="1.1string来存储多个键值对"></a>1.1string来存储多个键值对</h4><p>String 里面一个值只能对应一个对象</p>
<p>hash里面一个</p>
<p>利用key为冒号分层的效果，达到目的</p>
<p>set food:meat:beaf  1</p>
<p>set food:meat:pork  2</p>
<p>keys food*</p>
<p>String来存储多个键值对</p>
<p>mset批量set</p>
<p>第一级表名：第二级主键的值：第三级字段的名称   字段的内容</p>
<p>key不同导致不好</p>
<h4 id="hash来存储对个键值对"><a href="#hash来存储对个键值对" class="headerlink" title="hash来存储对个键值对"></a>hash来存储对个键值对</h4><p>hash</p>
<p>key–field–value</p>
<p><strong>好处：</strong></p>
<p>1.节省空间—–不用冒号，用聚集</p>
<p>2.减少命名冲突—用一个key</p>
<p>3.减少资源消耗—不用mget，用hget，只用一个key，不用多个key</p>
<p><strong>坏处：</strong></p>
<p>1.过期只能对key，不能对field</p>
<p>2.bit位</p>
<p>3.每个field 500M，有500 field，hash里面集群只能对key取模导致不能对单个key分布式</p>
<p><strong>指令：</strong></p>
<p>hset h1 f 6</p>
<p>hmset h1 a 1 b 2 c 3 d 4</p>
<p>hget h1 a</p>
<p>hmget h1 a b c d</p>
<p>hkeys h1</p>
<p>hvals h1</p>
<p>hgetall h1</p>
<p>hget exists h1</p>
<p>hdel h1 f</p>
<p>hlen h1</p>
<p>hincrby h1 a 10</p>
<p>hincrby h1 a -10</p>
<p><strong>购物车：</strong></p>
<p>key:用户id</p>
<p>field：商品id</p>
<p>value：商品数量</p>
<p>删除 hdel</p>
<p>全选 hgetall</p>
<p>商品数量 hlen</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/24/springboot自动装配/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-23T18:12:00.700Z" itemprop="datePublished"> Published 2021-08-24</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="springboot自动装配"><a href="#springboot自动装配" class="headerlink" title="springboot自动装配"></a>springboot自动装配</h3><h4 id="1-IOC流程"><a href="#1-IOC流程" class="headerlink" title="1.IOC流程"></a>1.IOC流程</h4><p>1.把所有要托管的spring管理的bean拿到，beanDefinition，并且放到beanDefinitionMap</p>
<p>2.bean实例化，进行属性注入</p>
<p>3.初始化Bean，是否实现BeanNameAware</p>
<p>4.是否实现了BeanPostProcessor类，调用postProcessBeforeIn</p>
<p>5.初始化方法</p>
<p>6.是否实现了BeanPostProcessor类，调用postProcessAfterIn。。。。AOP实现</p>
<p>入口在哪里</p>
<p>refresh（）</p>
<p>扫描</p>
<p>1.默认会扫描当前目录及子目录下@Service @Component @Controller @Repository @Bean @Configuration</p>
<p>2.加注解@ComponentScans（{“com.huihui.demo”,”com.huihui.boot”}）,或@Import（ClassB.class）</p>
<p>3.importselector selectimport</p>
<p>4.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">SpringApplication.run---&gt;refreshContext---refresh---this.finishBeanFactoryInitialization(beanFactory)---eanFactory.preInstantiateSingletons()---getBean---doGetBean---createBean---doCreateBean</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void refresh() throws BeansException, IllegalStateException &#123;</span><br><span class="line">        synchronized(this.startupShutdownMonitor) &#123;</span><br><span class="line">            this.prepareRefresh();</span><br><span class="line">            ConfigurableListableBeanFactory beanFactory = this.obtainFreshBeanFactory();</span><br><span class="line">            this.prepareBeanFactory(beanFactory);</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                this.postProcessBeanFactory(beanFactory);</span><br><span class="line">                this.invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line">                this.registerBeanPostProcessors(beanFactory);</span><br><span class="line">                this.initMessageSource();</span><br><span class="line">                this.initApplicationEventMulticaster();</span><br><span class="line">                this.onRefresh();</span><br><span class="line">                this.registerListeners();</span><br><span class="line">                this.finishBeanFactoryInitialization(beanFactory);//getbean的方法</span><br><span class="line">                this.finishRefresh();</span><br><span class="line">            &#125; catch (BeansException var9) &#123;</span><br><span class="line">                if (this.logger.isWarnEnabled()) &#123;</span><br><span class="line">                    this.logger.warn(&quot;Exception encountered during context initialization - cancelling refresh attempt: &quot; + var9);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                this.destroyBeans();</span><br><span class="line">                this.cancelRefresh(var9);</span><br><span class="line">                throw var9;</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                this.resetCommonCaches();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">protected Object doCreateBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args) throws BeanCreationException &#123;</span><br><span class="line">    BeanWrapper instanceWrapper = null;</span><br><span class="line">    if (mbd.isSingleton()) &#123;</span><br><span class="line">        //2.创建实例</span><br><span class="line">        instanceWrapper = (BeanWrapper)this.factoryBeanInstanceCache.remove(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (instanceWrapper == null) &#123;</span><br><span class="line">        instanceWrapper = this.createBeanInstance(beanName, mbd, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object bean = instanceWrapper.getWrappedInstance();</span><br><span class="line">    Class&lt;?&gt; beanType = instanceWrapper.getWrappedClass();</span><br><span class="line">    if (beanType != NullBean.class) &#123;</span><br><span class="line">        mbd.resolvedTargetType = beanType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    synchronized(mbd.postProcessingLock) &#123;</span><br><span class="line">        if (!mbd.postProcessed) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                this.applyMergedBeanDefinitionPostProcessors(mbd, beanType, beanName);</span><br><span class="line">            &#125; catch (Throwable var17) &#123;</span><br><span class="line">                throw new BeanCreationException(mbd.getResourceDescription(), beanName, &quot;Post-processing of merged bean definition failed&quot;, var17);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mbd.postProcessed = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    boolean earlySingletonExposure = mbd.isSingleton() &amp;&amp; this.allowCircularReferences &amp;&amp; this.isSingletonCurrentlyInCreation(beanName);</span><br><span class="line">    if (earlySingletonExposure) &#123;</span><br><span class="line">        if (this.logger.isTraceEnabled()) &#123;</span><br><span class="line">            this.logger.trace(&quot;Eagerly caching bean &#x27;&quot; + beanName + &quot;&#x27; to allow for resolving potential circular references&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this.addSingletonFactory(beanName, () -&gt; &#123;</span><br><span class="line">            return this.getEarlyBeanReference(beanName, mbd, bean);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object exposedObject = bean;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        //2.属性注入，DI</span><br><span class="line">        this.populateBean(beanName, mbd, instanceWrapper);</span><br><span class="line">        //3.初始化Bean，是否实现BeanNameAware</span><br><span class="line">        exposedObject = this.initializeBean(beanName, exposedObject, mbd);</span><br><span class="line">    &#125; catch (Throwable var18) &#123;</span><br><span class="line">        if (var18 instanceof BeanCreationException &amp;&amp; beanName.equals(((BeanCreationException)var18).getBeanName())) &#123;</span><br><span class="line">            throw (BeanCreationException)var18;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        throw new BeanCreationException(mbd.getResourceDescription(), beanName, &quot;Initialization of bean failed&quot;, var18);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (earlySingletonExposure) &#123;</span><br><span class="line">        Object earlySingletonReference = this.getSingleton(beanName, false);</span><br><span class="line">        if (earlySingletonReference != null) &#123;</span><br><span class="line">            if (exposedObject == bean) &#123;</span><br><span class="line">                exposedObject = earlySingletonReference;</span><br><span class="line">            &#125; else if (!this.allowRawInjectionDespiteWrapping &amp;&amp; this.hasDependentBean(beanName)) &#123;</span><br><span class="line">                String[] dependentBeans = this.getDependentBeans(beanName);</span><br><span class="line">                Set&lt;String&gt; actualDependentBeans = new LinkedHashSet(dependentBeans.length);</span><br><span class="line">                String[] var12 = dependentBeans;</span><br><span class="line">                int var13 = dependentBeans.length;</span><br><span class="line"></span><br><span class="line">                for(int var14 = 0; var14 &lt; var13; ++var14) &#123;</span><br><span class="line">                    String dependentBean = var12[var14];</span><br><span class="line">                    if (!this.removeSingletonIfCreatedForTypeCheckOnly(dependentBean)) &#123;</span><br><span class="line">                        actualDependentBeans.add(dependentBean);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (!actualDependentBeans.isEmpty()) &#123;</span><br><span class="line">                    throw new BeanCurrentlyInCreationException(beanName, &quot;Bean with name &#x27;&quot; + beanName + &quot;&#x27; has been injected into other beans [&quot; + StringUtils.collectionToCommaDelimitedString(actualDependentBeans) + &quot;] in its raw version as part of a circular reference, but has eventually been wrapped. This means that said other beans do not use the final version of the bean. This is often the result of over-eager type matching - consider using &#x27;getBeanNamesForType&#x27; with the &#x27;allowEagerInit&#x27; flag turned off, for example.&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        this.registerDisposableBeanIfNecessary(beanName, bean, mbd);</span><br><span class="line">        return exposedObject;</span><br><span class="line">    &#125; catch (BeanDefinitionValidationException var16) &#123;</span><br><span class="line">        throw new BeanCreationException(mbd.getResourceDescription(), beanName, &quot;Invalid destruction signature&quot;, var16);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">protected Object initializeBean(String beanName, Object bean, @Nullable RootBeanDefinition mbd) &#123;</span><br><span class="line">    if (System.getSecurityManager() != null) &#123;</span><br><span class="line">        AccessController.doPrivileged(() -&gt; &#123;</span><br><span class="line">            //3.初始化Bean，是否实现BeanNameAware</span><br><span class="line">            this.invokeAwareMethods(beanName, bean);</span><br><span class="line">            return null;</span><br><span class="line">        &#125;, this.getAccessControlContext());</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        this.invokeAwareMethods(beanName, bean);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object wrappedBean = bean;</span><br><span class="line">    if (mbd == null || !mbd.isSynthetic()) &#123;</span><br><span class="line">       4.是否实现了BeanPostProcessor类，调用postProcessBeforeIn</span><br><span class="line">        wrappedBean = this.applyBeanPostProcessorsBeforeInitialization(bean, beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        //5.初始化方法</span><br><span class="line">        this.invokeInitMethods(beanName, wrappedBean, mbd);</span><br><span class="line">    &#125; catch (Throwable var6) &#123;</span><br><span class="line">        throw new BeanCreationException(mbd != null ? mbd.getResourceDescription() : null, beanName, &quot;Invocation of init method failed&quot;, var6);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (mbd == null || !mbd.isSynthetic()) &#123;</span><br><span class="line">       //6.是否实现了BeanPostProcessor类，调用postProcessAfterIn。。。。AOP实现</span><br><span class="line">        wrappedBean = this.applyBeanPostProcessorsAfterInitialization(wrappedBean, beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return wrappedBean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="2-手写start组件"><a href="#2-手写start组件" class="headerlink" title="2.手写start组件"></a>2.手写start组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@SpringBootApplication-&gt;@EnableAutoConfiguration-&gt;@Import(&#123;AutoConfigurationImportSelector.class&#125;)-&gt;DeferredImportSelector-&gt;ImportSelector-&gt;selectImports-&gt;this.getAutoConfigurationEntry-&gt;this.getCandidateConfigurations-&gt; SpringFactoriesLoader.loadFactoryNames-&gt;loadSpringFactories-&gt;classLoader.getResources(&quot;META-INF/spring.factories&quot;)</span><br></pre></td></tr></table></figure>

<p>META-INF/spring</p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210824013535315.png" alt="image-20210824013535315"></p>
<p>1.写一个自动装配的类</p>
<p>PersonTest</p>
<p>2.META-INF/spring.factories 添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=\</span><br><span class="line">com.example.start001.start.PersonTest</span><br></pre></td></tr></table></figure>

<p>3.pom文件里面build删除，防止maven冲突</p>
<p>4.clean,package,install</p>
<p>5.其他项目引入当前项目生产的maven包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;groupId&gt;com.example.start001&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;start&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/23/Nacos应用/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-22T16:43:43.340Z" itemprop="datePublished"> Published 2021-08-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="Nacos应用"><a href="#Nacos应用" class="headerlink" title="Nacos应用"></a>Nacos应用</h3><h4 id="nacos的基本应用"><a href="#nacos的基本应用" class="headerlink" title="nacos的基本应用"></a>nacos的基本应用</h4><p>统一配置管理，服务注册与发现</p>
<p>服务注册中心如下图</p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210822145229484.png" alt="image-20210822145229484"></p>
<h4 id="下载与安装"><a href="#下载与安装" class="headerlink" title="下载与安装"></a>下载与安装</h4><p>下载nacos的安装包后，直接解压打开startup.cmd -m standalone（下载路径<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1186nmlqPGows9gUZKAx8Zw#list/path=%2F%EF%BC%8C%E5%AF%86%E7%A0%81%EF%BC%9Areset%EF%BC%89">https://pan.baidu.com/s/1186nmlqPGows9gUZKAx8Zw#list/path=%2F，密码：reset）</a></p>
<p>安装方法与tomcat安装类似，直接解压即可使用</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8848/nacos/">http://localhost:8848/nacos/</a></p>
<p>spring boot集成nacos</p>
<p>配置中心</p>
<p>nacos的整体架构</p>
<p>nacos集群</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/19/阿里巴巴云商城--一业务架构知识学习/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-18T16:59:12.697Z" itemprop="datePublished"> Published 2021-08-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="阿里巴巴云商城–一业务架构知识学习"><a href="#阿里巴巴云商城–一业务架构知识学习" class="headerlink" title="阿里巴巴云商城–一业务架构知识学习"></a>阿里巴巴云商城–一业务架构知识学习</h3><h4 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h4><p>1.云商城架构学习</p>
<p>2.基础数据管理，分布式文件管理</p>
<p>3.高性能门户首页构建</p>
<p>4.海量数据搜索实现</p>
<p>5.详情页实战</p>
<p>6.购物车、订单</p>
<p>7.分布式事务解决方案</p>
<p>8.微信支付</p>
<p>9.商品秒杀-数据处理</p>
<p>10.商品秒杀-热点数据实时发现系统</p>
<p>11.商品秒杀-程序隔离解决方案</p>
<p>12.官网鉴权</p>
<p>13.生产环境灾难控制</p>
<p>14.百万并发站点构建</p>
<h4 id="业务架构环境"><a href="#业务架构环境" class="headerlink" title="业务架构环境"></a>业务架构环境</h4><p>电商模式</p>
<p>业务学习</p>
<p>云商城架构</p>
<p>云商城表结构</p>
<p>搭建环境</p>
<p>增删改查实现</p>
<h4 id="业务功能"><a href="#业务功能" class="headerlink" title="业务功能"></a>业务功能</h4><p>商品增删改查</p>
<p>参数增删改查</p>
<p>订单增删改查</p>
<p>列表分类，首页广告（考虑并发）</p>
<p>动态搜索条件-es</p>
<p>加入购物车</p>
<p>用户登录</p>
<p>选择指定商品，进行下单</p>
<p>支付</p>
<p>秒杀并发量</p>
<p>秒杀商品流量控制</p>
<h4 id="前后端分离开发模式"><a href="#前后端分离开发模式" class="headerlink" title="前后端分离开发模式"></a>前后端分离开发模式</h4><p>js-html-jsp</p>
<p>vue，elementUI，nodeJS</p>
<p>用swagger定义接口，开发restful接口，最后更改接口路径</p>
<p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210818225523479.png" alt="image-20210818225523479"></p>
<h4 id="swagger的使用"><a href="#swagger的使用" class="headerlink" title="swagger的使用"></a>swagger的使用</h4><h4 id="云商城技术架构讲解"><a href="#云商城技术架构讲解" class="headerlink" title="云商城技术架构讲解"></a>云商城技术架构讲解</h4><p>用户—lvs400w—ngnix5w—gateway网关（限流，建权）—后端微服务—分布式事务—数据库</p>
<h4 id="云商城技术架构"><a href="#云商城技术架构" class="headerlink" title="云商城技术架构"></a>云商城技术架构</h4><p>客户端</p>
<ul>
<li>PC     H5    小程序    Android    IOS</li>
</ul>
<p>接入层</p>
<ul>
<li>心跳切换VIP： keepalived    keepalived    keepalived    keepalived</li>
<li>四层负载：       LVS集群          LVS集群          LVS集群          LVS集群         </li>
<li>七层负载：       Nginx集群      Nginx集群      Nginx集群      Nginx集群      </li>
</ul>
<p>网关层</p>
<ul>
<li><p>应用网关：         Gateway Filter Gateway Router Gateway鉴权 Gateway限流</p>
<p>​                             水平拓展</p>
</li>
</ul>
<p>服务层</p>
<ul>
<li>商品服务    订单服务    用户服务    搜索服务    秒杀服务</li>
</ul>
<p>​                               SpringCloud Alibaba技术栈</p>
<p>数据同步</p>
<ul>
<li>ES搜索数据同步   热门数据同步  缓存数据同步  静态页同步   Proxy缓存同步</li>
</ul>
<p>服务治理</p>
<ul>
<li>服务主册    服务发现    统一配置    服务熔断    服务限流</li>
</ul>
<p>数据处理</p>
<ul>
<li><p>MySQL    Redis6.x高速缓存    Ceph分布式文件存储     ElasticSearch千亿级数据    Apache Druid千亿日志析</p>
</li>
<li><p>Kafka实时日志收集   RocketMQ统一消息处理    XXL-Job分布式 事务    MongoDB购物车永久保存</p>
</li>
</ul>
<p>第三方接口</p>
<ul>
<li>短信通道    支付通道</li>
</ul>
<p>​    微信、阿里云短信平台</p>
<h4 id="云商城表结构分析"><a href="#云商城表结构分析" class="headerlink" title="云商城表结构分析"></a>云商城表结构分析</h4><p>集中式架构—-一个数据库</p>
<p>分布式架构——对业务进行拆分</p>
<p>订单明细</p>
<p>秒杀表</p>
<p>商品公共表</p>
<p>商品单独表</p>
<h4 id="项目开发准备环境"><a href="#项目开发准备环境" class="headerlink" title="项目开发准备环境"></a>项目开发准备环境</h4><p>redis cluster，ES，springcloud alibaba nacos，MySQL5.7，docker</p>
<p><img src="C:\Users\admin\Desktop\阿里巴巴云商城--一业务架构知识学习\image-20210820000137587.png" alt="image-20210820000137587"></p>
<p><img src="C:\Users\admin\Desktop\阿里巴巴云商城--一业务架构知识学习\image-20210820000339972.png" alt="image-20210820000339972"></p>
<h4 id="项目结构详解"><a href="#项目结构详解" class="headerlink" title="项目结构详解"></a>项目结构详解</h4>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/17/rabbitmq操作指南/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-16T17:27:19.715Z" itemprop="datePublished"> Published 2021-08-17</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="rabbitmq操作指南"><a href="#rabbitmq操作指南" class="headerlink" title="rabbitmq操作指南"></a>rabbitmq操作指南</h3><h4 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h4><ul>
<li>创建工厂（host，port，virtualhost，username，password）</li>
<li>创建连接</li>
<li>创建channel</li>
<li>调用channel</li>
</ul>
<p>消费者方法：channel.basicConsume(,,)</p>
<p>消费者创建mq配置：channel.exchangeDeclare；channel.queueDeclare；channel.queueBind</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建工厂</span></span><br><span class="line">ConnectionFactory factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line"><span class="comment">// 连接IP</span></span><br><span class="line">factory.setHost(<span class="string">&quot;192.168.1.128&quot;</span>);</span><br><span class="line"><span class="comment">// 默认监听端口</span></span><br><span class="line">factory.setPort(<span class="number">5672</span>);</span><br><span class="line"><span class="comment">// 虚拟机</span></span><br><span class="line">factory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置访问的用户</span></span><br><span class="line">factory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">factory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line"><span class="comment">// 2.建立连接</span></span><br><span class="line">Connection conn = factory.newConnection();</span><br><span class="line"><span class="comment">// 3.创建消息通道</span></span><br><span class="line">Channel channel = conn.createChannel();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建消费者</span></span><br><span class="line">        Consumer consumer = <span class="keyword">new</span> DefaultConsumer(channel) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties,</span></span></span><br><span class="line"><span class="params"><span class="function">                                       <span class="keyword">byte</span>[] body)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                String msg = <span class="keyword">new</span> String(body, <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;Received message : &#x27;&quot;</span> + msg + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;consumerTag : &quot;</span> + consumerTag );</span><br><span class="line">                System.out.println(<span class="string">&quot;deliveryTag : &quot;</span> + envelope.getDeliveryTag() );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.开始获取消息</span></span><br><span class="line"><span class="comment">// String queue, boolean autoAck, Consumer callback</span></span><br><span class="line">channel.basicConsume(QUEUE_NAME, <span class="keyword">true</span>, consumer);</span><br></pre></td></tr></table></figure>





<h4 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h4><ul>
<li>创建工厂</li>
<li>创建连接</li>
<li>创建通道</li>
<li>发送消息</li>
</ul>
<p>生产者方法：channel.basicpublish(,,)</p>
<p>生产者必须关闭通道和连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.创建工厂</span></span><br><span class="line">ConnectionFactory factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line"><span class="comment">// 连接IP</span></span><br><span class="line">factory.setHost(<span class="string">&quot;192.168.1.128&quot;</span>);</span><br><span class="line"><span class="comment">// 连接端口</span></span><br><span class="line">factory.setPort(<span class="number">5672</span>);</span><br><span class="line"><span class="comment">// 虚拟机</span></span><br><span class="line">factory.setVirtualHost(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"><span class="comment">// 用户</span></span><br><span class="line">factory.setUsername(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">factory.setPassword(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.建立连接</span></span><br><span class="line">Connection conn = factory.newConnection();</span><br><span class="line"><span class="comment">// 3.创建消息通道</span></span><br><span class="line">Channel channel = conn.createChannel();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.发送消息</span></span><br><span class="line">String msg = <span class="string">&quot;Hello world, Rabbit MQ&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// String exchange, String routingKey, BasicProperties props, byte[] body</span></span><br><span class="line">channel.basicPublish(EXCHANGE_NAME, <span class="string">&quot;gupao.best&quot;</span>, <span class="keyword">null</span>, msg.getBytes());</span><br><span class="line"></span><br><span class="line">channel.close();</span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure>



<h4 id="队列删除"><a href="#队列删除" class="headerlink" title="队列删除"></a>队列删除</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">channel.queueDelete</span><br><span class="line">channel.exchangeDelete</span><br></pre></td></tr></table></figure>



<h3 id="死信队列"><a href="#死信队列" class="headerlink" title="死信队列"></a>死信队列</h3><p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210817010215043.png" alt="image-20210817010215043"></p>
<p>生产者抛消息给队列，队列没有消息，队列绑定了过期的exchange或者queue，消息里面有设置过期时间，过期后就把消息丢给对应的exchange或者queue</p>
<p>启用插件</p>
<p>rabbitmq-plugins enable rabbitmq_management</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2021/08/16/rabbitmq 工作模型/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="yorkiiz" target="_blank" itemprop="author">yorkiiz</a>
		
  <p class="article-time">
    <time datetime="2021-08-15T17:15:36.690Z" itemprop="datePublished"> Published 2021-08-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="rabbitmq-工作模型"><a href="#rabbitmq-工作模型" class="headerlink" title="rabbitmq 工作模型"></a>rabbitmq 工作模型</h3><p><img src="C:\Users\admin\AppData\Roaming\Typora\typora-user-images\image-20210814110251211.png" alt="image-20210814110251211"></p>
<p>生产者–channel–broker–channel–consumer</p>
<p>broker里面的queue是放在erlang写的Mnesia数据库里面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">while&#123;</span><br><span class="line"></span><br><span class="line">   channel.basicGet();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">channel.basicPublish(msg);</span><br><span class="line"></span><br><span class="line">channel.basicPublish(flag,msg);</span><br></pre></td></tr></table></figure>



<p>exchange来路由消息</p>
<p>vhost</p>
<h3 id="Exchange路由消息详解"><a href="#Exchange路由消息详解" class="headerlink" title="Exchange路由消息详解"></a>Exchange路由消息详解</h3><h4 id="直连类型"><a href="#直连类型" class="headerlink" title="直连类型"></a>直连类型</h4><p>![image-20210814141557476](C:\Users\admin\Desktop\rabbitmq 工作模型\image-20210814141557476.png)</p>
<p>消息的路由键：routing key</p>
<p>channel.basicPublish(exc_name,”spring”,”msg1”);</p>
<p>exc_name:exchange直连交换机名称</p>
<p>spring：routing key</p>
<p>msg1：消息内容</p>
<p>路由键==绑定建</p>
<h4 id="topic主题"><a href="#topic主题" class="headerlink" title="topic主题"></a>topic主题</h4><p>*一个单词</p>
<p>#0个或者多个单词</p>
<p>routing key可以带通配符</p>
<h4 id="fanout广播"><a href="#fanout广播" class="headerlink" title="fanout广播"></a>fanout广播</h4><p>routing key为空</p>
<p> 所有绑定exchange的queue都会收到消息</p>
<h3 id="rabbitmq的基本使用"><a href="#rabbitmq的基本使用" class="headerlink" title="rabbitmq的基本使用"></a>rabbitmq的基本使用</h3><p>1.引入依赖</p>
<p>2.消费者</p>
<p>3.生产者</p>
<p>4.</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next&lt;span&gt;&lt;&#x2F;span&gt;</a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  

  

  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m yorkiiz in github. <br/>
			天道酬勤.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2021 
		
		<a href="/about" target="_blank" title="yorkiiz">yorkiiz</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
